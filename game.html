<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row =>
                    row.some(cell => cell !== '' && cell !== null && cell !== undefined)
                );

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
</script>
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–¢–∞–π–Ω–∞ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ –õ–æ–≥–∞—Ä–∏—Ñ–º–∞: –•–∞–∫–µ—Ä—Å–∫–∞—è –º–∏—Å—Å–∏—è</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
      font-family: 'Courier New', monospace;
      background: #1a1a1a;
      color: #00ff00;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      position: relative;
      font-size: 1.2rem;
    }
    canvas.matrix {
      position: fixed;
      top: 0;
      left: 0;
      z-index: -1;
      opacity: 0.2;
    }
    header {
      background: #0d1b2a;
      padding: 1.5rem;
      box-shadow: 0 0 15px #00ff00;
      position: relative;
      z-index: 1;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .header-content {
      display: flex;
      align-items: center;
      width: 100%;
      max-width: 1200px;
      position: relative;
    }
    .logo {
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 80px;
      height: 80px;
    }
    h1 {
      font-size: 2.5rem;
      text-shadow: 0 0 8px #00ff00;
      margin: 0 0 0 100px;
      text-align: left;
    }
    h2 {
      font-size: 2rem;
      text-shadow: 0 0 6px #00ff00;
    }
    main {
      max-width: 1200px;
      margin: 3rem auto;
      padding: 1.5rem;
      position: relative;
      z-index: 1;
    }
    .scene {
      background: #2c2c2c;
      padding: 3rem;
      border-radius: 15px;
      box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
      margin-bottom: 3rem;
      font-size: 1.3rem;
    }
    .btn {
      background: linear-gradient(45deg, #00cc00, #006600);
      color: #fff;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      margin: 0.75rem;
      font-size: 1.2rem;
      text-transform: uppercase;
      font-weight: bold;
    }
    .btn:hover {
      transform: scale(1.1);
      box-shadow: 0 0 20px rgba(0, 255, 0, 0.7);
    }
    .btn.back-btn {
      background: linear-gradient(45deg, #ff3333, #990000);
      color: #fff;
    }
    .draggable {
      cursor: grab;
      position: relative;
      z-index: 10;
      display: inline-block;
    }
    .draggable:hover {
      opacity: 0.8;
    }
    .draggable:active {
      cursor: grabbing;
    }
    .inventory-item {
      position: relative;
      font-size: 60px;
      line-height: 60px;
      cursor: grab;
    }
    .dropzone {
      width: 120px;
      height: 120px;
      border: 3px dashed #00ff00;
      margin: 0.75rem;
      display: inline-block;
      text-align: center;
      vertical-align: top;
      padding-top: 40px;
      background: rgba(0, 255, 0, 0.1);
      font-size: 1.2rem;
    }
    .key-drop {
      font-size: 1rem;
    }
    .search-area {
      position: relative;
      width: 500px;
      height: 300px;
      background: #333;
      margin: 1.5rem auto;
      overflow: hidden;
      border: 3px solid #00ff00;
    }
    .search-item {
      position: absolute;
      width: 50px;
      height: 50px;
      cursor: pointer;
      transition: transform 0.3s, opacity 0.3s;
    }
    .search-item:hover {
      transform: scale(1.2);
      opacity: 0.8;
    }
    .locked::after {
      content: "üîí";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      text-align: center;
      line-height: 50px;
      font-size: 40px;
      background: rgba(0,0,0,0.7);
    }
    .wire-task {
      position: relative;
      width: 500px;
      height: 300px;
      margin: 1.5rem auto;
      background: #222;
      border: 3px solid #00ff00;
    }
    .wire-point {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      cursor: pointer;
      position: absolute;
      text-align: center;
      line-height: 50px;
      font-weight: bold;
      transition: box-shadow 0.3s;
      background: #00ff00;
      color: #000;
      font-size: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 5px;
      box-sizing: border-box;
      white-space: normal;
      overflow: hidden;
    }
    .wire-point.active {
      box-shadow: 0 0 15px #00ff00;
    }
    .wire-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }
    .hidden {
      display: none;
    }
    .ending {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: #00ff00;
      text-align: center;
      animation: fadeIn 0.5s;
      z-index: 2;
      font-size: 1.5rem;
    }
    .sad-ending {
      background: linear-gradient(to bottom, #1a1a1a, #2c3e50 50%, #0f1c2b);
    }
    .menu-btn {
      margin-top: 3rem;
      font-size: 1.5rem;
      padding: 1rem 2rem;
      animation: pulse 1.5s infinite;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    @media (max-width: 768px) {
      .header-content {
        flex-direction: column;
        align-items: center;
      }
      .logo {
        position: static;
        transform: none;
        margin-bottom: 1rem;
      }
      h1 {
        margin: 0;
        text-align: center;
        font-size: 1.8rem;
      }
    }
  </style>
</head>
<body>
  <canvas class="matrix" id="matrix"></canvas>
  <header>
    <div class="header-content">
      <img src="https://i.postimg.cc/q74Fdnpr/IMG-20250415-113958.png" alt="Logo" class="logo">
      <h1>–¢–∞–π–Ω–∞ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ –õ–æ–≥–∞—Ä–∏—Ñ–º–∞: –•–∞–∫–µ—Ä—Å–∫–∞—è –º–∏—Å—Å–∏—è</h1>
    </div>
  </header>
  <main>
    <!-- –°—Ü–µ–Ω–∞ 1: –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ -->
    <section class="scene" id="scene1">
      <h2>–ü—Ä–æ–ø–∞–≤—à–∏–π –≥–µ–Ω–∏–π</h2>
      <p>–ü—Ä–æ—Ñ–µ—Å—Å–æ—Ä –õ–æ–≥–∞—Ä–∏—Ñ–º, –ª–µ–≥–µ–Ω–¥–∞ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏, –∑–∞–≥–∞–¥–æ—á–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –∏—Å—á–µ–∑. –ï–≥–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–ª–µ–¥ –≤–µ–¥—ë—Ç –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é "ZeroDivision". –í—ã ‚Äî –æ–ø—ã—Ç–Ω—ã–π —Ö–∞–∫–µ—Ä, –ø—Ä–∏–∑–≤–∞–Ω–Ω—ã–π —Ä–∞—Å–∫—Ä—ã—Ç—å –ø—Ä–∞–≤–¥—É. –ü–µ—Ä–µ–¥ –≤–∞–º–∏ –∑–∞–ø–µ—Ä—Ç–∞—è –¥–≤–µ—Ä—å, –º–∏–≥–∞—é—â–∏–π —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ —Å—Ç—Ä–∞–Ω–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏. –ù–∞—á–Ω–∏—Ç–µ —Å–≤–æ—é –º–∏—Å—Å–∏—é!</p>
      <button class="btn" onclick="startPath()">–ù–∞—á–∞—Ç—å –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ</button>
    </section>

    <!-- –§–∞–∑–∞ 1: –ü–æ–∏—Å–∫ –¥–æ—Å—Ç—É–ø–∞ -->
    <section class="scene hidden" id="path1">
      <h2>–§–∞–∑–∞ 1 ‚Äì –ü–æ–∏—Å–∫ –¥–æ—Å—Ç—É–ø–∞</h2>
      <p>–ü–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–º–æ–¥–∑–∏, —Å–∫—Ä—ã—Ç—ã—Ö –∑–∞ –∑–∞–º–∫–∞–º–∏ —Å –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏. –†–µ—à–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –∑–∞–º–∫–∏. –ù–∞–π–¥–∏—Ç–µ –∫–ª—é—á ¬´üîë¬ª!</p>
      <div class="search-area" id="search1">
        <div class="search-item locked" style="top: 60px; left: 120px;" data-hidden="üíæ" 
             onclick="unlockItem(this, '3', 'üíæ', 'log‚ÇÇ(8)')"></div>
        <div class="search-item locked" style="top: 180px; left: 240px;" data-hidden="üîß" 
             onclick="unlockItem(this, '5', 'üîß', '‚àö(16 + 9)')"></div>
        <div class="search-item locked" style="top: 40px; left: 40px;" data-hidden="üì±" 
             onclick="unlockItem(this, '2', 'üì±', '‚à´‚ÇÄ¬≤ x dx')"></div>
        <div class="search-item locked" style="top: 100px; left: 150px;" data-hidden="üñ•Ô∏è" 
             onclick="unlockItem(this, '30', 'üñ•Ô∏è', '5! / 4')"></div>
        <div class="search-item locked" style="top: 180px; left: 300px;" data-hidden="üñ®Ô∏è" 
             onclick="unlockItem(this, '1', 'üñ®Ô∏è', 'sin(œÄ/2)')"></div>
        <div class="search-item locked" style="top: 260px; left: 120px;" data-hidden="üì∑" 
             onclick="unlockItem(this, '4', 'üì∑', '2x - 4 = 4')"></div>
        <div class="search-item locked" style="top: 60px; left: 360px;" data-hidden="üóùÔ∏è" 
             onclick="unlockItem(this, '1', 'üóùÔ∏è', 'e‚Å∞')"></div>
        <div class="search-item locked" style="top: 240px; left: 420px;" data-hidden="üîë" 
             onclick="unlockItem(this, '2', 'üîë', 'log‚ÇÉ(9)')"></div>
      </div>
      <p id="result1" class="hidden"></p>
      <button class="btn back-btn" onclick="goBack(1)">–ù–∞–∑–∞–¥</button>
    </section>

    <!-- –§–∞–∑–∞ 2: –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–æ–≤ -->
    <section class="scene hidden" id="path2">
      <h2>–§–∞–∑–∞ 2 ‚Äì –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–æ–≤</h2>
      <p>–ù–∞ –ø–∞–Ω–µ–ª–∏ —Å–ª–µ–≤–∞ ‚Äî —á–∏—Å–ª–∞, —Å–ø—Ä–∞–≤–∞ ‚Äî –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è. –°–æ–µ–¥–∏–Ω–∏—Ç–µ –∏—Ö –ø—Ä–æ–≤–æ–¥–∞–º–∏ —Ç–∞–∫, —á—Ç–æ–±—ã –∫–∞–∂–¥–æ–µ —á–∏—Å–ª–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –≤—ã—Ä–∞–∂–µ–Ω–∏—è. –ü—Ä–æ–≤–æ–¥–∞ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞—Ç—å, –ø–æ–∫–∞ –≤—Å–µ –ø–∞—Ä—ã –Ω–µ –±—É–¥—É—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏.</p>
      <div class="wire-task" id="wireTask">
        <!-- Left side (numbers) -->
        <div class="wire-point" id="left1" style="top: 30px; left: 30px;" onclick="startWire('v1', this)">16</div>
        <div class="wire-point" id="left2" style="top: 100px; left: 30px;" onclick="startWire('v2', this)">6</div>
        <div class="wire-point" id="left3" style="top: 170px; left: 30px;" onclick="startWire('v3', this)">2</div>
        <div class="wire-point" id="left4" style="top: 240px; left: 30px;" onclick="startWire('v4', this)">1</div>
        <!-- Right side (equations, swapped positions) -->
        <div class="wire-point" id="right1" style="top: 240px; left: 420px;" data-equation="Math.cos(0)" onclick="connectWire(this)">cos(0)</div>
        <div class="wire-point" id="right2" style="top: 170px; left: 420px;" data-equation="Math.sqrt(4)" onclick="connectWire(this)">‚àö4</div>
        <div class="wire-point" id="right3" style="top: 100px; left: 420px;" data-equation="factorial(3)" onclick="connectWire(this)">3!</div>
        <div class="wire-point" id="right4" style="top: 30px; left: 420px;" data-equation="Math.pow(2, 4)" onclick="connectWire(this)">2‚Å¥</div>
        <canvas class="wire-canvas" id="wireCanvas"></canvas>
      </div>
      <p id="result2" class="hidden"></p>
      <button class="btn back-btn" onclick="goBack(2)">–ù–∞–∑–∞–¥</button>
    </section>

    <!-- –§–∞–∑–∞ 3: –£—Å–ª–æ–∂–Ω—ë–Ω–Ω—ã–π —Ä–µ–±—É—Å -->
    <section class="scene hidden" id="path3">
      <h2>–§–∞–∑–∞ 3 ‚Äì –†–µ–±—É—Å</h2>
      <p>–†–µ–±—É—Å:<br>
         1. –ü–µ—Ä–≤–∞—è –±—É–∫–≤–∞ —Å–ª–æ–≤–∞ ¬´—Å–µ–∫—Ä–µ—Ç¬ª;<br>
         2. –ö–æ—Ä–µ–Ω—å —Å–ª–æ–≤–∞ ¬´–∫—Ä—ã—à–∞¬ª (–ø–µ—Ä–≤—ã–µ —Ç—Ä–∏ –±—É–∫–≤—ã);<br>
         3. –û–∫–æ–Ω—á–∞–Ω–∏–µ —Å–ª–æ–≤–∞ ¬´–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å¬ª (–ø–æ—Å–ª–µ–¥–Ω–∏–µ —á–µ—Ç—ã—Ä–µ –±—É–∫–≤—ã).<br>
         –ú–µ–∂–¥—É 2-–π –∏ 3-–π —á–∞—Å—Ç—è–º–∏ –≤—Å—Ç–∞–≤—å—Ç–µ –±—É–∫–≤—ã ¬´–¢–ù¬ª.<br>
         –ö–∞–∫–æ–π –ø–æ–ª—É—á–∏—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç?</p>
      <button class="btn" onclick="solveRebus()">–†–µ—à–∏—Ç—å —Ä–µ–±—É—Å</button>
      <p id="result3" class="hidden"></p>
      <button class="btn back-btn" onclick="goBack(3)">–ù–∞–∑–∞–¥</button>
    </section>

    <!-- –§–∞–∑–∞ 4: –®–∏—Ñ—Ä -->
    <section class="scene hidden" id="path4">
      <h2>–§–∞–∑–∞ 4 ‚Äì –®–∏—Ñ—Ä</h2>
      <p>–†–∞—Å—à–∏—Ñ—Ä—É–π—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:<br>
         <strong>"–ª–ø–µ —Ä—Å–ø—Ö–∂—Ç—Ç–ø—Å–± –º–ø–¥–±—Å–π—Ö–Ω–±"</strong><br>
         –ü–æ–¥—Å–∫–∞–∑–∫–∞: —Å–¥–≤–∏–Ω—å—Ç–µ –∫–∞–∂–¥—É—é –±—É–∫–≤—É –Ω–∞ 1 –Ω–∞–∑–∞–¥.<br>
         –û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∏—Ç—å—Å—è: <em>–∫–æ–¥ –ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä–∞ –ª–æ–≥–∞—Ä–∏—Ñ–º–∞</em>.
      </p>
      <button class="btn" onclick="solveCipher()">–†–µ—à–∏—Ç—å —à–∏—Ñ—Ä</button>
      <p id="result4" class="hidden"></p>
      <button class="btn back-btn" onclick="goBack(4)">–ù–∞–∑–∞–¥</button>
    </section>

    <!-- –§–∞–∑–∞ 5: –°–µ–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª -->
    <section class="scene hidden" id="path5">
      <h2>–§–∞–∑–∞ 5 ‚Äì –°–µ–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª</h2>
      <p>–í—ã –ø–æ–ø–∞–ª–∏ –≤ —Å–µ–∫—Ä–µ—Ç–Ω—É—é –∫–æ–º–Ω–∞—Ç—É. –¢–µ—Ä–º–∏–Ω–∞–ª —Ç—Ä–µ–±—É–µ—Ç –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞. –ù–∞ –∑–∞–ø–∏—Å–∫–µ –Ω–∞–ø–∏—Å–∞–Ω–æ: "–ü—Ä–æ—Ñ–µ—Å—Å–æ—Ä –∑–¥–µ—Å—å". –†–µ—à–∏—Ç–µ, –∫–∞–∫ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å:</p>
      <button class="btn" onclick="chooseAction(5, 'hack')">–í–∑–ª–æ–º–∞—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª</button>
      <button class="btn" onclick="chooseAction(5, 'search')">–ò—Å–∫–∞—Ç—å –¥—Ä—É–≥–æ–π –ø—É—Ç—å</button>
      <p id="result5" class="hidden"></p>
      <button class="btn back-btn" onclick="goBack(5)">–ù–∞–∑–∞–¥</button>
    </section>

    <!-- –§–∞–∑–∞ 6: –§–∏–Ω–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä -->
    <section class="scene hidden" id="path6">
      <h2>–§–∞–∑–∞ 6 ‚Äì –§–∏–Ω–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä</h2>
      <p id="finalText"></p>
      <button class="btn" id="choice6a" onclick="chooseAction(6, 'save')"></button>
      <button class="btn" id="choice6b" onclick="chooseAction(6, 'leave')"></button>
      <p id="result6" class="hidden">–ù–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω –ø–æ–¥ —Ç–µ—Ä–º–∏–Ω–∞–ª–æ–º! –≠—Ç–æ—Ç –∫–ª—é—á (üîë) —Ä–∞–≤–µ–Ω 25. –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –µ–≥–æ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å–∫–≤–∞–∂–∏–Ω—É, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø.</p>
      <div class="inventory-item draggable" id="keyCenter" draggable="true" ondragstart="drag(event)" style="margin: 1.5rem auto; text-align: center;">
        üîë
      </div>
      <div id="keyDropzonesContainer" style="text-align: center; margin-top: 1.5rem;">
        <div class="dropzone key-drop" data-answer="25">5√ó5</div>
        <div class="dropzone key-drop" data-answer="20">10+10</div>
        <div class="dropzone key-drop" data-answer="26">30-4</div>
        <div class="dropzone key-drop" data-answer="16.67">50/3</div>
      </div>
      <p id="attemptsInfo" style="text-align: center; margin-top: 1.5rem;"></p>
      <div id="extraChallenge" class="hidden" style="margin-top: 1.5rem;">
        <button class="btn" id="extraChallengeBtn" onclick="showNextStep(7)">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ: –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–∫—Ü–∏—è</button>
      </div>
      <button class="btn back-btn" onclick="goBack(6)">–ù–∞–∑–∞–¥</button>
    </section>

    <!-- –§–∞–∑–∞ 7: –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–∫—Ü–∏—è -->
    <section class="scene hidden" id="path7">
      <h2>–§–∞–∑–∞ 7 ‚Äì –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–∫—Ü–∏—è</h2>
      <p>–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –∑–∞–≤–µ—Ä—à–∏—Ç—å –º–∏—Å—Å–∏—é, —Å–∏—Å—Ç–µ–º–∞ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∞—à–µ–π —Ä–µ–∞–∫—Ü–∏–∏! –ü–æ–π–º–∞–π—Ç–µ –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ –ø–∞–¥–∞—é—â–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∑–∞ 10 —Å–µ–∫—É–Ω–¥!</p>
      <canvas id="reactionGame" width="500" height="350" style="border:3px solid #00ff00; background:#222;"></canvas>
      <p id="reactionResult" class="hidden"></p>
      <button class="btn hidden" id="restartGameBtn" onclick="restartGame()">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
      <div style="margin-top: 1.5rem;">
        <button class="btn" onclick="showNextStep(8)">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º—É –∑–∞–¥–∞–Ω–∏—é</button>
      </div>
      <button class="btn back-btn" onclick="goBack(7)">–ù–∞–∑–∞–¥</button>
    </section>

    <!-- –§–∞–∑–∞ 8: –ú–∏–≥–∞–ª–∫–∞ -->
    <section class="scene hidden" id="path8">
      <h2>–§–∞–∑–∞ 8 ‚Äì –ú–∏–≥–∞–ª–∫–∞</h2>
      <p>–í–∞—à–∞ –º–∏—Å—Å–∏—è –±–ª–∏–∑–∫–∞ –∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –º–∏–≥–∞—é—â—É—é —Ç–æ—á–∫—É –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ, —á—Ç–æ–±—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–µ!</p>
      <canvas id="blinkGame" width="500" height="350" style="border:3px solid #00ff00; background:#222;"></canvas>
      <p id="blinkResult" class="hidden"></p>
      <button class="btn hidden" id="restartBlinkBtn" onclick="restartBlinkGame()">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
      <div style="margin-top: 1.5rem;">
        <button class="btn" onclick="showEnding(1)">–ó–∞–≤–µ—Ä—à–∏—Ç—å –∏–≥—Ä—É</button>
      </div>
      <button class="btn back-btn" onclick="goBack(8)">–ù–∞–∑–∞–¥</button>
    </section>

    <!-- –ö–æ–Ω—Ü–æ–≤–∫–∏ -->
    <div class="ending" id="ending1">
      <h2>–¢—Ä–∏—É–º—Ñ —Ö–∞–∫–µ—Ä–∞!</h2>
      <img src="https://i.postimg.cc/HkBMfR38/file-00000000757061f8a4740df6f148b3f4-conversation-id-67f90bca-1d9c-8012-90ff-ad1c6de7e000-message-i.png" alt="Victory Scene" style="max-width: 400px; margin: 1.5rem;">
      <p>–í–∞—à –≥–µ–Ω–∏–∞–ª—å–Ω—ã–π –≤–∑–ª–æ–º —Å–ø–∞—Å –ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä–∞ –õ–æ–≥–∞—Ä–∏—Ñ–º–∞! –í—ã —Ä–∞–∑—Ä—É—à–∏–ª–∏ –ø–ª–∞–Ω—ã "ZeroDivision", –∏ —Ç–µ–ø–µ—Ä—å –º–∏—Ä –Ω–∞—É–∫–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è –≤–∞–º!</p>
      <button class="btn menu-btn" onclick="window.location.href='index.html'">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
    </div>
    <div class="ending sad-ending" id="ending2">
      <h2>–¢—è–∂—ë–ª—ã–π –≤—ã–±–æ—Ä...</h2>
      <img src="https://i.postimg.cc/HLNyLMqp/file-0000000048f461f88461417d7faf5243-conversation-id-67f90bca-1d9c-8012-90ff-ad1c6de7e000-message-i.png" alt="Failure Scene" style="max-width: 400px; margin: 1.5rem;">
      <p>–í—ã —É—à–ª–∏ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏, —Ä–∞—Å–∫—Ä—ã–≤ —á–∞—Å—Ç—å —Ç–∞–π–Ω "ZeroDivision". –ù–æ –ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä –æ—Å—Ç–∞–ª—Å—è –≤ –ø–ª–µ–Ω—É, –∏ –µ–≥–æ —Å—É–¥—å–±–∞ —Ç–µ—Ä–∑–∞–µ—Ç –≤–∞—à—É —Å–æ–≤–µ—Å—Ç—å...</p>
      <button class="btn menu-btn" onclick="window.location.href='index.html'">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
    </div>
    <div class="ending sad-ending" id="ending3">
      <h2>–ü—É—Ç—å –æ–¥–∏–Ω–æ—á–∫–∏</h2>
      <img src="https://i.postimg.cc/HLNyLMqp/file-0000000048f461f88461417d7faf5243-conversation-id-67f90bca-1d9c-8012-90ff-ad1c6de7e000-message-i.png" alt="Failure Scene" style="max-width: 400px; margin: 1.5rem;">
      <p>–í—ã –ø—Ä–µ–¥–ø–æ—á–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –æ—Å—Ç–∞–≤–∏–≤ –ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä–∞ –Ω–∞ –º–∏–ª–æ—Å—Ç—å –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏. "ZeroDivision" –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å–≤–æ–∏ —Ç—ë–º–Ω—ã–µ –¥–µ–ª–∞, –∞ –≤—ã —Å–∫—Ä—ã–≤–∞–µ—Ç–µ—Å—å –≤ —Ç–µ–Ω—è—Ö...</p>
      <button class="btn menu-btn" onclick="window.location.href='index.html'">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
    </div>
  </main>

  <!-- –ö–∞–Ω–≤–∞—Å—ã –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π –∫–æ–Ω—Ü–æ–≤–æ–∫ -->
  <canvas id="confettiCanvas" style="position: fixed; top: 0; left: 0; z-index: 3; pointer-events: none;"></canvas>
  <canvas id="rainCanvas" style="position: fixed; top: 0; left: 0; z-index: 3; pointer-events: none;"></canvas>

  <script>
    let currentStep = 1;
    let wiresConnected = {};
    let activeConnection = null;
    let choicesMade = {};
    let keyAttempts = 3;
    const wireCanvas = document.getElementById('wireCanvas');
    const wireCtx = wireCanvas.getContext('2d');
    wireCanvas.width = 500;
    wireCanvas.height = 300;

    function factorial(n) {
      if (n === 0 || n === 1) return 1;
      return n * factorial(n - 1);
    }

    function updateAttemptsInfo() {
      document.getElementById('attemptsInfo').textContent = "–û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫: " + keyAttempts;
    }
    updateAttemptsInfo();

    const matrixCanvas = document.getElementById('matrix');
    const matrixCtx = matrixCanvas.getContext('2d');
    matrixCanvas.width = window.innerWidth;
    matrixCanvas.height = window.innerHeight;
    const chars = '01';
    const fontSize = 18;
    const columns = matrixCanvas.width / fontSize;
    const drops = Array(Math.floor(columns)).fill(0);

    function drawMatrix() {
      matrixCtx.fillStyle = 'rgba(0, 0, 0, 0.05)';
      matrixCtx.fillRect(0, 0, matrixCanvas.width, matrixCanvas.height);
      matrixCtx.fillStyle = '#00ff00';
      matrixCtx.font = fontSize + 'px monospace';
      drops.forEach((y, i) => {
        const text = chars[Math.floor(Math.random() * chars.length)];
        const x = i * fontSize;
        matrixCtx.fillText(text, x, y);
        if (y > matrixCanvas.height && Math.random() > 0.975) drops[i] = 0;
        drops[i] += fontSize;
      });
      requestAnimationFrame(drawMatrix);
    }
    drawMatrix();

    function startPath() {
      document.getElementById('scene1').className = 'scene hidden';
      document.getElementById('path1').className = 'scene';
      currentStep = 1;
    }

    function goBack(step) {
      if (step === 1) {
        document.getElementById(`path${step}`).className = 'scene hidden';
        document.getElementById('scene1').className = 'scene';
        currentStep = 1;
      } else {
        showNextStep(step - 1);
      }
      // Reset phase-specific data if needed
      if (step === 2) {
        wiresConnected = {};
        activeConnection = null;
        wireCtx.clearRect(0, 0, wireCanvas.width, wireCanvas.height);
      }
      if (step === 6) {
        keyAttempts = 3;
        updateAttemptsInfo();
        document.getElementById('keyCenter').style.display = 'block';
      }
    }

    function unlockItem(element, expectedAnswer, hiddenEmoji, equation) {
      let answer = prompt(`–†–µ—à–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ:\n${equation}\n(–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º):`);
      if (answer && answer.trim() === expectedAnswer) {
        element.classList.remove("locked");
        element.textContent = hiddenEmoji;
        if (hiddenEmoji === "üîë") {
          document.getElementById('result1').textContent = "–ö–ª—é—á –Ω–∞–π–¥–µ–Ω! –ß—Ç–æ –¥–∞–ª—å—à–µ?";
          document.getElementById('result1').className = "";
          addChoices(1);
        }
      } else {
        alert("–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.");
      }
    }

    function startWire(id, startPoint) {
      if (activeConnection && activeConnection.id === id) {
        activeConnection.startPoint.classList.remove('active');
        document.removeEventListener('mousemove', activeConnection.moveWire);
        activeConnection = null;
        drawWires();
        return;
      }
      if (activeConnection) return;
      if (wiresConnected[id]) {
        delete wiresConnected[id];
      }
      let startRect = startPoint.getBoundingClientRect();
      let canvasRect = wireCanvas.getBoundingClientRect();
      activeConnection = {
        id: id,
        startX: startRect.left - canvasRect.left + 25,
        startY: startRect.top - canvasRect.top + 25,
        startPoint: startPoint
      };
      startPoint.classList.add('active');
      activeConnection.moveWire = function(event) {
        let endX = event.clientX - canvasRect.left;
        let endY = event.clientY - canvasRect.top;
        drawWires(endX, endY);
      };
      document.addEventListener('mousemove', activeConnection.moveWire);
    }

    function connectWire(endPoint) {
      if (!activeConnection) return;
      let endRect = endPoint.getBoundingClientRect();
      let canvasRect = wireCanvas.getBoundingClientRect();
      let endX = endRect.left - canvasRect.left + 25;
      let endY = endRect.top - canvasRect.top + 25;
      let equation = endPoint.dataset.equation;
      let computed = eval(equation);
      let startValue = activeConnection.startPoint.textContent;
      if (parseInt(startValue) === computed) {
        wiresConnected[activeConnection.id] = {
          startX: activeConnection.startX,
          startY: activeConnection.startY,
          endX: endX,
          endY: endY
        };
        activeConnection.startPoint.classList.remove('active');
        document.removeEventListener('mousemove', activeConnection.moveWire);
        activeConnection = null;
        checkWires();
      } else {
        alert("–ù–µ–≤–µ—Ä–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ ‚Äì —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç!");
        activeConnection.startPoint.classList.remove('active');
        document.removeEventListener('mousemove', activeConnection.moveWire);
        activeConnection = null;
      }
      drawWires();
    }

    function drawWires(tempEndX, tempEndY) {
      wireCtx.clearRect(0, 0, wireCanvas.width, wireCanvas.height);
      for (let id in wiresConnected) {
        let { startX, startY, endX, endY } = wiresConnected[id];
        wireCtx.beginPath();
        wireCtx.strokeStyle = "#00ff00";
        wireCtx.lineWidth = 5;
        wireCtx.shadowColor = "#00ff00";
        wireCtx.shadowBlur = 15;
        wireCtx.lineCap = "round";
        wireCtx.moveTo(startX, startY);
        wireCtx.lineTo(endX, endY);
        wireCtx.stroke();
        wireCtx.shadowBlur = 0;
      }
      if (activeConnection) {
        wireCtx.beginPath();
        wireCtx.strokeStyle = "#00ff00";
        wireCtx.lineWidth = 3;
        wireCtx.moveTo(activeConnection.startX, activeConnection.startY);
        let endX = tempEndX || activeConnection.startX;
        let endY = tempEndY || activeConnection.startY;
        wireCtx.lineTo(endX, endY);
        wireCtx.stroke();
      }
    }

    function checkWires() {
      if (Object.keys(wiresConnected).length === 4) {
        document.getElementById('result2').textContent = "–ü—Ä–æ–≤–æ–¥–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ! –ß—Ç–æ –¥–∞–ª—å—à–µ?";
        document.getElementById('result2').className = "";
        addChoices(2);
      }
    }

    function solveRebus() {
      let answer = prompt("–†–µ–±—É—Å:\n1. –ü–µ—Ä–≤–∞—è –±—É–∫–≤–∞ —Å–ª–æ–≤–∞ ¬´—Å–µ–∫—Ä–µ—Ç¬ª;\n2. –ö–æ—Ä–µ–Ω—å —Å–ª–æ–≤–∞ ¬´–∫—Ä—ã—à–∞¬ª (–ø–µ—Ä–≤—ã–µ —Ç—Ä–∏ –±—É–∫–≤—ã);\n3. –û–∫–æ–Ω—á–∞–Ω–∏–µ —Å–ª–æ–≤–∞ ¬´–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å¬ª (–ø–æ—Å–ª–µ–¥–Ω–∏–µ —á–µ—Ç—ã—Ä–µ –±—É–∫–≤—ã).\n\n–í—Å—Ç–∞–≤—å—Ç–µ –±—É–∫–≤—ã ¬´–¢–ù¬ª –º–µ–∂–¥—É 2-–π –∏ 3-–π —á–∞—Å—Ç—è–º–∏. –ö–∞–∫–æ–π –ø–æ–ª—É—á–∏—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç?");
      if (answer && answer.trim().toLowerCase() === "—Å–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å") {
        document.getElementById('result3').textContent = "–†–µ–±—É—Å —Ä–∞–∑–≥–∞–¥–∞–Ω! –ß—Ç–æ –¥–∞–ª—å—à–µ?";
        document.getElementById('result3').className = "";
        addChoices(3);
      } else {
        alert("–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.");
      }
    }

    function solveCipher() {
      let answer = prompt("–†–∞—Å—à–∏—Ñ—Ä—É–π—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:\n\"–ª–ø–µ —Ä—Å–ø—Ö–∂—Ç—Ç–ø—Å–± –º–ø–¥–±—Å–π—Ö–Ω–±\"\n–ü–æ–¥—Å–∫–∞–∑–∫–∞: —Å–¥–≤–∏–Ω—å—Ç–µ –∫–∞–∂–¥—É—é –±—É–∫–≤—É –Ω–∞ 1 –Ω–∞–∑–∞–¥.");
      if (answer && answer.trim().toLowerCase() === "–∫–æ–¥ –ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä–∞ –ª–æ–≥–∞—Ä–∏—Ñ–º–∞") {
        document.getElementById('result4').textContent = "–®–∏—Ñ—Ä —Ä–∞–∑–≥–∞–¥–∞–Ω! –ß—Ç–æ –¥–∞–ª—å—à–µ?";
        document.getElementById('result4').className = "";
        addChoices(4);
      } else {
        alert("–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.");
      }
    }

    function drag(event) {
      event.dataTransfer.setData("text", event.target.id);
    }

    function setupKeyDropzones() {
      document.querySelectorAll('.key-drop').forEach(dropzone => {
        dropzone.ondragover = (event) => event.preventDefault();
        dropzone.ondrop = function(event) {
          event.preventDefault();
          let itemId = event.dataTransfer.getData("text");
          if (itemId === 'keyCenter') {
            if (this.dataset.answer === "25") {
              this.innerHTML = "–ö–ª—é—á –≤—Å—Ç–∞–≤–ª–µ–Ω!";
              showEnding(choicesMade[5] === 'hack' ? (choicesMade[6] === 'save' ? 1 : 3) : 2);
            } else {
              keyAttempts--;
              updateAttemptsInfo();
              if (keyAttempts <= 0) {
                alert("–ü–æ–ø—ã—Ç–∫–∏ –∏—Å—á–µ—Ä–ø–∞–Ω—ã! –ù–∞—á–Ω–∏—Ç–µ —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Ñ–∞–∑—É –∑–∞–Ω–æ–≤–æ.");
                keyAttempts = 3;
                updateAttemptsInfo();
                document.getElementById('keyCenter').style.display = 'block';
              } else {
                alert("–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–∫–≤–∞–∂–∏–Ω–∞! –û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫: " + keyAttempts);
              }
            }
          }
        };
      });
    }

    function addChoices(step) {
      let result = document.getElementById(`result${step}`);
      result.innerHTML += `
        <br><button class="btn" onclick="chooseAction(${step}, 'continue')">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        <button class="btn" onclick="chooseAction(${step}, 'restart')">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
      `;
    }

    function chooseAction(step, action) {
      if (action === 'continue' && step < 5) {
        showNextStep(step + 1);
      } else if (action === 'restart') {
        showNextStep(1);
        wiresConnected = {};
        choicesMade = {};
        activeConnection = null;
        wireCtx.clearRect(0, 0, wireCanvas.width, wireCanvas.height);
      } else if (step === 5) {
        choicesMade[5] = action;
        document.getElementById('result5').textContent = action === 'hack' ?
          "–¢–µ—Ä–º–∏–Ω–∞–ª –≤–∑–ª–æ–º–∞–Ω! –ó–∞ —Å—Ç–µ–∫–ª–æ–º –≤–∏–¥–Ω–µ–µ—Ç—Å—è —Å–∏–ª—É—ç—Ç –ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä–∞." :
          "–í—ã –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏ —Ç–∞–π–Ω—ã–π –≤—ã—Ö–æ–¥ —Å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.";
        document.getElementById('result5').className = "";
        document.getElementById('finalText').textContent = action === 'hack' ?
          "–ü—Ä–æ—Ñ–µ—Å—Å–æ—Ä —Ä–∞–Ω–µ–Ω, –Ω–æ –∂–∏–≤. –°–ø–∞—Å—Ç–∏ –µ–≥–æ –∏–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤ –æ–¥–∏–Ω–æ—á–∫—É?" :
          "–î–æ–∫—É–º–µ–Ω—Ç—ã —Ä–∞—Å–∫—Ä—ã–≤–∞—é—Ç –ø—Ä–∞–≤–¥—É, –Ω–æ –ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä –æ—Å—Ç–∞—ë—Ç—Å—è –≤ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ—Å—Ç–∏. –í–∞—à –≤—ã–±–æ—Ä?";
        document.getElementById('choice6a').textContent = action === 'hack' ? "–°–ø–∞—Å—Ç–∏ –ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä–∞" : "–£–π—Ç–∏ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏";
        document.getElementById('choice6b').textContent = action === 'hack' ? "–û—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ" : "–í–µ—Ä–Ω—É—Ç—å—Å—è –∑–∞ –ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä–æ–º";
        showNextStep(6);
      } else if (step === 6) {
        choicesMade[6] = action;
        document.getElementById('result6').className = "";
        let key = document.getElementById('keyCenter');
        key.style.display = 'block';
        setupKeyDropzones();
      }
    }

    function showNextStep(step) {
      document.getElementById(`path${currentStep}`).className = 'scene hidden';
      currentStep = step;
      document.getElementById(`path${currentStep}`).className = 'scene';
      if (currentStep === 7) {
        startGame();
      }
      if (currentStep === 8) {
        startBlinkGame();
      }
    }

    function showEnding(ending) {
      const key = document.getElementById('keyCenter');
      if (key) {
        key.style.display = 'none';
      }
      document.querySelectorAll('.scene').forEach(scene => {
        scene.className = 'scene hidden';
      });
      document.getElementById(`ending${ending}`).style.display = 'flex';
      if (ending === 1) {
        startConfetti();
      } else {
        startRain();
      }
    }

    // –ö–æ–Ω—Ñ–µ—Ç—Ç–∏ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω –¥–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–π –∫–æ–Ω—Ü–æ–≤–∫–∏
    const confettiCanvas = document.getElementById('confettiCanvas');
    const confettiCtx = confettiCanvas.getContext('2d');
    confettiCanvas.width = window.innerWidth;
    confettiCanvas.height = window.innerHeight;

    function startConfetti() {
      let particles = [];

      function createParticle() {
        return {
          x: Math.random() * confettiCanvas.width,
          y: -10,
          vx: (Math.random() - 0.5) * 6,
          vy: Math.random() * 6 + 3,
          size: Math.random() * 8 + 5,
          life: 150,
          color: `hsl(${Math.random() * 360}, 80%, 60%)`,
          shape: Math.random() < 0.5 ? 'square' : 'circle'
        };
      }

      function updateParticles() {
        if (particles.length < 100 && Math.random() < 0.3) {
          particles.push(createParticle());
        }
        particles = particles.filter(p => p.life > 0 && p.y < confettiCanvas.height + p.size);
        confettiCtx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
        particles.forEach(p => {
          p.x += p.vx;
          p.y += p.vy;
          p.vx += (Math.random() - 0.5) * 0.2;
          p.life--;
          confettiCtx.beginPath();
          confettiCtx.fillStyle = p.color;
          if (p.shape === 'square') {
            confettiCtx.fillRect(p.x - p.size / 2, p.y - p.size / 2, p.size, p.size);
          } else {
            confettiCtx.arc(p.x, p.y, p.size / 2, 0, Math.PI * 2);
            confettiCtx.fill();
          }
        });
        requestAnimationFrame(updateParticles);
      }

      updateParticles();
    }

    // –î–æ–∂–¥—å –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω –¥–ª—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–Ω—Ü–æ–≤–æ–∫
    const rainCanvas = document.getElementById('rainCanvas');
    const rainCtx = rainCanvas.getContext('2d');
    rainCanvas.width = window.innerWidth;
    rainCanvas.height = window.innerHeight;

    function startRain() {
      let drops = [];

      function createDrop() {
        return {
          x: Math.random() * rainCanvas.width,
          y: -10,
          length: Math.random() * 20 + 10,
          speed: Math.random() * 5 + 5,
          opacity: Math.random() * 0.5 + 0.3
        };
      }

      function updateDrops() {
        if (drops.length < 80 && Math.random() < 0.4) {
          drops.push(createDrop());
        }
        drops = drops.filter(d => d.y < rainCanvas.height + d.length);
        rainCtx.clearRect(0, 0, rainCanvas.width, rainCanvas.height);
        drops.forEach(d => {
          d.y += d.speed;
          rainCtx.beginPath();
          rainCtx.strokeStyle = `rgba(0, 191, 255, ${d.opacity})`;
          rainCtx.lineWidth = 2;
          rainCtx.moveTo(d.x, d.y);
          rainCtx.lineTo(d.x, d.y + d.length);
          rainCtx.stroke();
        });
        requestAnimationFrame(updateDrops);
      }

      updateDrops();
    }

    let gameObjects = [];
    let score = 0;
    let gameInterval = null;
    let gameStartTime = 0;
    const gameCanvas = document.getElementById('reactionGame');
    const gameCtx = gameCanvas.getContext('2d');

    function startGame() {
      score = 0;
      gameObjects = [];
      gameStartTime = Date.now();
      document.getElementById('reactionResult').classList.add('hidden');
      document.getElementById('restartGameBtn').classList.add('hidden');
      gameCanvas.addEventListener('click', gameClick);
      gameInterval = setInterval(updateGame, 50);
    }

    function updateGame() {
      const elapsed = Date.now() - gameStartTime;
      if (Math.random() < 0.1) {
        gameObjects.push({
          x: Math.random() * (gameCanvas.width - 20),
          y: -20,
          r: 18,
          speed: 2 + Math.random() * 3
        });
      }
      gameObjects.forEach(obj => {
        obj.y += obj.speed;
      });
      gameObjects = gameObjects.filter(obj => obj.y - obj.r < gameCanvas.height);
      drawGame();
      if (elapsed > 10000) {
        endGame();
      }
    }

    function drawGame() {
      gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
      gameObjects.forEach(obj => {
        gameCtx.beginPath();
        gameCtx.fillStyle = "#00ff00";
        gameCtx.arc(obj.x, obj.y, obj.r, 0, Math.PI * 2);
        gameCtx.fill();
      });
      gameCtx.font = "24px Courier New";
      gameCtx.fillStyle = "#00ff00";
      gameCtx.fillText("–°—á—ë—Ç: " + score, 10, 30);
    }

    function gameClick(event) {
      const rect = gameCanvas.getBoundingClientRect();
      const clickX = event.clientX - rect.left;
      const clickY = event.clientY - rect.top;
      for (let i = 0; i < gameObjects.length; i++) {
        const obj = gameObjects[i];
        const dist = Math.sqrt((clickX - obj.x) ** 2 + (clickY - obj.y) ** 2);
        if (dist < obj.r) {
          score++;
          gameObjects.splice(i, 1);
          break;
        }
      }
    }

    function endGame() {
      clearInterval(gameInterval);
      gameCanvas.removeEventListener('click', gameClick);
      document.getElementById('reactionResult').textContent = "–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Å—á—ë—Ç: " + score;
      document.getElementById('reactionResult').className = "";
      document.getElementById('restartGameBtn').classList.remove('hidden');
    }

    function restartGame() {
      startGame();
    }

    let blinkInterval = null;
    let blinkScore = 0;
    let blinkGameActive = false;
    const blinkCanvas = document.getElementById('blinkGame');
    const blinkCtx = blinkCanvas.getContext('2d');
    let currentBlink = null;

    function startBlinkGame() {
      blinkScore = 0;
      blinkGameActive = true;
      document.getElementById('blinkResult').classList.add('hidden');
      document.getElementById('restartBlinkBtn').classList.add('hidden');
      blinkCanvas.addEventListener('click', blinkGameClick);
      blinkInterval = setInterval(updateBlinkGame, 1000);
      setTimeout(endBlinkGame, 10000);
      drawBlinkGame();
    }

    function updateBlinkGame() {
      currentBlink = {
        x: Math.random() * (blinkCanvas.width - 40) + 20,
        y: Math.random() * (blinkCanvas.height - 40) + 20,
        r: 18
      };
      drawBlinkGame();
    }

    function drawBlinkGame() {
      blinkCtx.clearRect(0, 0, blinkCanvas.width, blinkCanvas.height);
      if (currentBlink) {
        blinkCtx.beginPath();
        blinkCtx.fillStyle = "#00ff00";
        blinkCtx.arc(currentBlink.x, currentBlink.y, currentBlink.r, 0, Math.PI * 2);
        blinkCtx.fill();
      }
      blinkCtx.font = "24px Courier New";
      blinkCtx.fillStyle = "#00ff00";
      blinkCtx.fillText("–°—á—ë—Ç: " + blinkScore, 10, 30);
    }

    function blinkGameClick(event) {
      if (!currentBlink) return;
      const rect = blinkCanvas.getBoundingClientRect();
      const clickX = event.clientX - rect.left;
      const clickY = event.clientY - rect.top;
      const dist = Math.sqrt((clickX - currentBlink.x) ** 2 + (clickY - currentBlink.y) ** 2);
      if (dist < currentBlink.r) {
        blinkScore++;
        currentBlink = null;
        drawBlinkGame();
      }
    }

    function endBlinkGame() {
      clearInterval(blinkInterval);
      blinkCanvas.removeEventListener('click', blinkGameClick);
      blinkGameActive = false;
      document.getElementById('blinkResult').textContent = "–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Å—á—ë—Ç: " + blinkScore;
      document.getElementById('blinkResult').className = "";
      document.getElementById('restartBlinkBtn').classList.remove('hidden');
    }

    function restartBlinkGame() {
      startBlinkGame();
    }
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'930a4f1c0987b03f',t:'MTc0NDcwODIxOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'930a70d04dc9adc3',t:'MTc0NDcwOTU5OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
</body>
</html>